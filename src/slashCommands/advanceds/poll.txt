const { SlashCommandBuilder, EmbedBuilder } = require("discord.js");

module.exports = {
  data: new SlashCommandBuilder()
    .setName("poll")
    .setDescription("Cria uma enquete para vota√ß√£o")
    .addStringOption(option => 
      option.setName("question")
        .setDescription("Pergunta da enquete")
        .setRequired(true))
    .addStringOption(option => 
      option.setName("option1")
        .setDescription("Primeira op√ß√£o")
        .setRequired(true))
    .addStringOption(option => 
      option.setName("option2")
        .setDescription("Segunda op√ß√£o")
        .setRequired(true))
    .addStringOption(option => 
      option.setName("option3")
        .setDescription("Terceira op√ß√£o")
        .setRequired(false))
    .addStringOption(option => 
      option.setName("option4")
        .setDescription("Quarta op√ß√£o")
        .setRequired(false)),

  async execute(interaction) {
    const question = interaction.options.getString("question");
    const option1 = interaction.options.getString("option1");
    const option2 = interaction.options.getString("option2");
    const option3 = interaction.options.getString("option3") || null;
    const option4 = interaction.options.getString("option4") || null;

    const options = [option1, option2, option3, option4].filter(option => option != null);
    const emojis = ["üá¶", "üáß", "üá®", "üá©"];

    let description = "";
    options.forEach((option, index) => {
      description += `${emojis[index]} ${option}\n`;
    });

    const embed = new EmbedBuilder()
      .setTitle(`Enquete: ${question}`)
      .setDescription(description)
      .setColor("#FFCC00")
      .setTimestamp();

    const pollMessage = await interaction.reply({ embeds: [embed], fetchReply: true });

    // Reage com emojis para cada op√ß√£o
    for (let i = 0; i < options.length; i++) {
      await pollMessage.react(emojis[i]);
    }
  },
};
